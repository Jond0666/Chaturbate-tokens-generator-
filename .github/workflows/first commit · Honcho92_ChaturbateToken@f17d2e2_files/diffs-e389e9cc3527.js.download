"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["diffs"],{92967:(e,t,n)=>{var r,o,s,l,i,a=n(59753),c=n(3126);(0,a.on)("click",".js-conversation-menu-button",function(){let e=!0;return async function(t){if(!1===e){let e=t.currentTarget,n=e.closest(".select-menu"),r=n.querySelector("details-menu");if(!r)return;r.textContent="";let o=`${r.getAttribute("src")}?instrument=1`,s=await fetch(o);s.ok&&(r.innerHTML=await s.text())}e=!1}}()),(0,a.on)("click",".js-conversations-menu-item",function(e){let t=e.currentTarget,n=t.closest(".js-conversations-details");n.hasAttribute("open")&&n.removeAttribute("open"),window.location.hash=t.hash,(0,c.kc)(document)}),(0,a.on)("click",".js-resolved-conversations",async function(e){let t=e.currentTarget.querySelector(".dropdown-caret"),n=e.currentTarget.querySelector(".select-menu-header");""===t.style.transform?t.style.transform="rotate(180deg)":t.style.transform="",n.classList.toggle("border-bottom-0")});var d=n(56959),u=n(81574),f=n(36071),m=n(33537);function g({currentTarget:e}){let t=e.hasAttribute("open"),n=e.closest(".js-file-header");n.classList.toggle("has-open-dropdown",t)}function h(){let e=Array.from(p()).filter(e=>e.checked);return e.map(e=>e.value)}function p(){return document.querySelectorAll(".js-diff-file-type-option")}function b(){let e=document.querySelector(".js-deleted-files-toggle");if(e instanceof HTMLInputElement)return e}function y(){return j().length>0}function j(){let e=document.querySelectorAll(".js-diff-owner-option"),t=Array.from(e).filter(e=>e.checked);return t.map(e=>e.value)}function v(){return h().length!==p().length}function S(){let e=document.querySelector(".js-manifests-option");return!!e&&e.checked}function w(){let e=b();return!!e&&!e.checked}function A(){let e=document.querySelector(".js-viewed-files-toggle");return!!e&&!e.checked}(0,a.on)("details:toggled-group",".js-file.js-details-container",function(e){e.target===e.currentTarget&&function(e){let t=document.querySelector(".js-file-filter");if(!t)return;let n=p();for(let t of n)t.checked=e;let r=b();r&&(r.checked=!e);let o=v()||w()||A()||y()||S();(function(e){let t=document.querySelector(".js-file-filter-text");t.classList.toggle("color-fg-accent",e)})(o),function(e){let t=document.querySelector(".js-reset-filters"),n=document.querySelector(".js-commits-filtered");null==t||n||(t.hidden=!e)}(o),function(){let e=p(),t=w();for(let n of e)if(t){let e="0"===n.getAttribute("data-non-deleted-files-count");n.disabled=e}else n.disabled=!1}(),function(){let e=v(),t=document.querySelector(".js-file-filter-select-all-container"),n=e?"data-select-all-markup":"data-all-selected-markup",r=t.getAttribute(n);t.textContent=r,t.classList.toggle("color-fg-muted",!e),t.classList.toggle("color-fg-accent",e)}(),function(){let e=document.querySelectorAll(".js-file-type-count");for(let t of e){let e=w()?"data-non-deleted-file-count-markup":"data-all-file-count-markup",n=t.getAttribute(e);n&&(t.textContent=n)}}(),(0,m.X)(o,function(){let e=new URLSearchParams(window.location.search);return e.has("w")}(),h(),y(),j(),S(),w(),A())}(e.detail.open)}),(0,a.on)("details:toggled",".js-file.js-details-container",function(e){if(e.target!==e.currentTarget)return;let t=e.currentTarget;t.getBoundingClientRect().top<0&&(0,c.zT)(t)}),(0,u.Z)(()=>{let e=window.location.hash.slice(1);if(!e)return;let t=document.getElementsByName(e)[0];if(!t)return;let n=t.nextElementSibling;n&&n.matches(".js-file.js-details-container")&&(n.classList.add("open"),n.classList.add("Details--on"))}),(0,f.N7)(".js-file-header-dropdown",{subscribe:e=>(0,d.RB)(e,"toggle",g)}),(0,a.on)("click",".js-jump-to-menu-item",function({currentTarget:e}){let t=e.getAttribute("href").substring(1),n=document.querySelector(`[data-anchor="${t}"]`);if(n){let e=n.closest(".js-file.js-details-container");e.hidden=!1}!function(){let e=document.querySelector(".js-file-filter-blankslate");if(!e)return;let t=document.querySelectorAll(".js-diff-progressive-loader");if(t.length>0){e.hidden=!0;return}let n=document.querySelectorAll(".js-file");if(0===n.length){e.hidden=!0;return}let r=Array.from(n).some(e=>!e.hidden);e.hidden=r}()});var q=n(78232),L=n(47851),E=n(69567),_=n(58700),T=n(82873),x=n(18699),C=n(65935);let k="```suggestion",M=RegExp(`${k}(?:.*)
`,"i"),I=RegExp("```(\n|$)");function R(e,t){let n=e.slice(0,t).split("\n");return e.split("\n")[n.length-1]}function H(e){let t=/^(\s+)/.exec(e);return t&&t[0]||""}function F(e,t,n=0){let r=t.substring(n,t.length),o=e.exec(r);return o?o.index+n:-1}function N(e,t){let n=[],r=0,o=-1;for(;(o=F(M,e,r))>-1;){r=o+k.length;let t=F(I,e,r);if(-1===t)return!1;r=t+3,n.push([o,t])}return n.some(e=>t>e[0]&&t<e[1])}var D=n(254),P=n(22971);let $={addToBatchEnabled:".js-add-to-batch-enabled",unchangedSuggestion:".js-unchanged-suggestion",closedOrMergedPull:".js-closed-pull",viewingSubset:".js-viewing-subset-changes",leftBlob:".js-validation-on-left-blob",rightBlob:".js-validation-on-right-blob",outdatedComment:".js-outdated-comment",resolvedThread:".js-resolved-thread",pendingReview:".js-pending-review",inMergeQueue:".js-in-merge-queue",headOidNotLoaded:".js-head-oid-not-loaded"};function O(e,t){let n=document.querySelectorAll(".js-apply-suggestion-button"),r=e.querySelector(".js-disabled-apply-suggestion-button");for(let e of n){let n=r.cloneNode(!0);W(n,t),e.closest("details").replaceWith(n)}}function B(e){let t=document.querySelector(".js-batched-suggested-changes-container");for(let n of(t&&t.classList.add("d-none"),document.querySelectorAll(".js-apply-single-suggestion")))n.classList.remove("d-none"),n.disabled=!0,n.setAttribute("aria-label",e);for(let t of document.querySelectorAll(".js-batched-suggested-changes-add"))t.classList.remove("d-none"),t.disabled=!0,t.setAttribute("aria-label",e);for(let e of document.querySelectorAll(".js-batched-suggested-changes-remove"))e.classList.add("d-none");for(let e of document.querySelectorAll(".js-focus-commit-suggestions-form-button"))e.classList.add("d-none");for(let e of document.querySelectorAll(".js-pending-batched-suggestion-label"))e.classList.add("d-none")}function W(e,t){e.setAttribute("aria-label",t),e.classList.remove("d-none")}function z(e,t){let n=document.querySelector(".js-suggested-changes-inline-validation-template").cloneNode(!0);n.classList.remove("js-suggested-changes-inline-validation-template");let r=n.querySelector(".js-suggested-changes-inline-error-message");r.textContent=e.trim();let o=t.parentNode;o.insertBefore(n,t.nextSibling)}function U(e){let t=document.querySelector(".js-suggested-changes-subset-files");if(!t)return;let n=e.querySelectorAll(".js-suggested-change-toolbar-item"),r=$.viewingSubset;if(!r)return;let o=document.querySelector(r).textContent.trim();for(let e of n){e.setAttribute("aria-disabled","true");let t=e.getAttribute("aria-describedby");if(!t)continue;let n=document.getElementById(t);n&&(n.textContent=o)}}function Q(){let e=document.querySelector(".js-batched-suggested-changes-container");e&&setTimeout(()=>(function(e){let t=e.closest(".js-review-state-classes"),n=t.querySelectorAll("[data-pending-batched-suggestion]").length;for(let e of document.querySelectorAll(".js-pending-batched-suggested-changes-count"))e.textContent=String(n);let r=document.querySelector(".js-reenable-add-to-batch").textContent;for(let e of document.querySelectorAll("[data-batched-suggestion-reenable-sibling]"))e.removeAttribute("data-batched-suggestion-reenable-sibling"),e.removeAttribute("disabled"),e.setAttribute("aria-label",r);if(n>0){e.hidden=!1;let t=e.querySelector(".js-batched-suggested-changes-toggle");for(let e of(t.classList.add("anim-pulse-in"),t.addEventListener("animationend",()=>t.classList.remove("anim-pulse-in"),{once:!0}),document.querySelectorAll(".js-apply-single-suggestion")))e.classList.add("d-none");for(let e of document.querySelectorAll(".js-batched-suggested-changes-add")){let t=e.closest(".js-suggested-change-form-container");"true"===t.getAttribute("data-pending-batched-suggestion")||"true"===t.getAttribute("data-comment-pending")||"true"===t.getAttribute("data-outdated-comment")?e.classList.add("d-none"):e.classList.remove("d-none"),"true"===e.getAttribute("data-batched-suggestion-disabled-by-sibling")&&(e.removeAttribute("data-batched-suggestion-disabled-by-sibling"),e.setAttribute("disabled","disabled"),e.setAttribute("aria-label",document.querySelector(".js-one-suggestion-per-line").textContent))}for(let e of document.querySelectorAll(".js-batched-suggested-changes-remove")){let t=e.closest(".js-suggested-change-form-container");"true"===t.getAttribute("data-pending-batched-suggestion")?e.classList.remove("d-none"):e.classList.add("d-none")}for(let e of document.querySelectorAll(".js-focus-commit-suggestions-form-button")){let t=e.closest(".js-suggested-change-form-container"),n="true"===t.getAttribute("data-comment-pending"),r="true"===t.getAttribute("data-outdated-comment"),o="true"===t.getAttribute("data-resolved-comment"),s=e.closest(".js-inline-comments-container"),l=s.querySelector('input[name="side"]'),i="left"===l.value;n||r||o||i?e.classList.add("d-none"):e.classList.remove("d-none")}for(let e of document.querySelectorAll(".js-pending-batched-suggestion-label")){let t=e.closest(".js-suggested-change-form-container");"true"===t.getAttribute("data-pending-batched-suggestion")?e.classList.remove("d-none"):e.classList.add("d-none")}}else{for(let t of(e.hidden=!0,document.querySelectorAll(".js-apply-single-suggestion")))t.classList.remove("d-none");for(let e of document.querySelectorAll(".js-batched-suggested-changes-add"))e.classList.remove("d-none");for(let e of document.querySelectorAll(".js-batched-suggested-changes-remove"))e.classList.add("d-none");for(let e of document.querySelectorAll(".js-focus-commit-suggestions-form-button"))e.classList.add("d-none");for(let e of document.querySelectorAll(".js-pending-batched-suggestion-label"))e.classList.add("d-none")}})(e))}function X(e,t){let n=e.querySelector("input[name=commit_title]"),r=e.querySelector("textarea[name=commit_message]"),o=n.value.trim();""===o&&(o=n.defaultValue);let s=r.value.trim();""!==s&&(o=`${o}

${s}
`),n.disabled=!0,r.disabled=!0;let l=document.createElement("input");l.setAttribute("type","hidden"),l.setAttribute("name","message"),l.value=o,e.appendChild(l);let i=document.createElement("input");i.setAttribute("type","hidden"),i.setAttribute("name","changes"),i.value=JSON.stringify(t),e.appendChild(i)}(0,a.on)("click",".js-suggested-change-toolbar-item",function(e){let t=e.currentTarget;t instanceof HTMLButtonElement&&"false"===t.getAttribute("aria-disabled")&&function(e){let t=e.getAttribute("data-lines");if(null!=t){let n=e.closest(".js-suggested-changes-container"),r=n.querySelector(".js-comment-field");!function(e,t){let n=`${k}
${e}
\`\`\``,r=t.selectionStart,o=t.value,s=F(/\n/,o,r),l=""===o.trim(),i=R(o,r),a=""===i.trim(),c=o,d=0;if(l)d=(c=n).length-4;else if(-1===s)d=a?(c=o+n).length-4:(c=[o,n].join("\n")).length-4;else if(a){let e=H(i),t=r-e.length,l=o.substring(0,t),a=o.substring(s,o.length);d=(c=[l,n,a].join("")).length-a.length-4}else if(N(o,r)){let e=F(/```/,o,r)+3,t=o.substring(0,e),s=o.substring(e,o.length);d=(c=[t,"\n",n,s].join("")).length-s.length-4}else{let e=o.substring(0,s),t=o.substring(s,o.length);d=(c=[e,"\n",n,t].join("")).length-t.length-4}(0,_.Se)(t,c),t.focus(),t.setSelectionRange(d,d)}(t,r)}}(t)}),(0,a.on)("click",".js-refresh-after-suggestion",P.H5),(0,f.N7)(".js-inline-comments-container",{add(e){U(e)}}),(0,f.N7)(".js-preview-body .js-apply-changes",{add(e){let t=e.closest(".js-suggested-changes-container");if(!t)return e.remove();let n=document.querySelector($.rightBlob).textContent,r=document.querySelector($.leftBlob).textContent,o=e.closest(".js-suggested-changes-blob");if(""!==t.getAttribute("data-thread-side")){if("left"===t.getAttribute("data-thread-side"))return z(r,o),e.remove()}else{let t=e.closest(".js-inline-comment-form"),n=t.querySelector('input[name="side"]');if(!t||!n)return e.remove();if(t&&"left"===n.value)return z(r,o),e.remove()}let s=e.previousElementSibling,l=s.querySelector(".js-blob-code-deletion"),i=s.querySelectorAll(".js-blob-code-addition");if(!l||0===i.length)return;let a=l.textContent,c=Array.from(i).map(e=>e.textContent);if(a===c.join("\n"))return z(n,o),e.remove();e.remove()}}),(0,f.N7)(".js-comment-body .js-apply-changes",{add(e){let t;let n=e.closest(".js-comment");if(!n)return e.remove();let r=n.querySelector(".js-suggested-changes-template");if(!(r instanceof HTMLTemplateElement))return e.remove();let o=r.content.cloneNode(!0),s=o.querySelector(".js-disabled-apply-suggestion-button");try{t=o.querySelector(".js-batched-suggested-changes-add")}catch(e){if("QueryError"!==e.name)throw e}if(document.querySelectorAll(".js-suggested-changes-files-tab").length){let e=document.querySelector($.addToBatchEnabled).textContent;t&&(t.removeAttribute("disabled"),t.setAttribute("aria-label",e))}let l=document.querySelector(".js-pull-header-details"),i=l&&"true"===l.getAttribute("data-pull-is-open"),a=e.closest(".js-resolvable-timeline-thread-container"),c="true"===r.getAttribute("data-comment-pending"),d="true"===r.getAttribute("data-in-merge-queue"),u=n.classList.contains("js-selection-contains-deletions");if(a&&"true"===a.getAttribute("data-resolved")){let n=document.querySelector($.resolvedThread).textContent,r=o.querySelector("details");return r&&r.remove(),W(s,n),t&&(t.setAttribute("disabled","disabled"),t.setAttribute("aria-label",n)),e.replaceWith(o)}if(!i){let n=document.querySelector($.closedOrMergedPull).textContent;return W(s,n),t&&(t.setAttribute("disabled","disabled"),t.setAttribute("aria-label",n)),e.replaceWith(o)}if(d){let n=document.querySelector($.inMergeQueue),r="";n&&(r=n.textContent||"");let l=o.querySelector("details");return l&&l.remove(),W(s,r),t&&(t.setAttribute("disabled","disabled"),t.setAttribute("aria-label",r)),e.replaceWith(o)}if(c){let n=document.querySelector($.pendingReview).textContent;return o.querySelector("details").remove(),W(s,n),t&&(t.setAttribute("disabled","disabled"),t.setAttribute("aria-label",n)),e.replaceWith(o)}if(u){let n=document.querySelector($.leftBlob).textContent;return o.querySelector("details").remove(),W(s,n),t&&(t.setAttribute("disabled","disabled"),t.setAttribute("aria-label",n)),e.replaceWith(o)}let f=document.querySelector(".js-suggested-changes-subset-files"),m="true"===r.getAttribute("data-outdated-comment");if(f||m){let n;return f?n=document.querySelector($.viewingSubset).textContent:m&&(n=document.querySelector($.outdatedComment).textContent),o.querySelector("details").remove(),W(s,n),t&&(t.setAttribute("disabled","disabled"),t.setAttribute("aria-label",n)),e.replaceWith(o)}let g=o.querySelector(".js-single-suggested-change-form"),h=e.closest(".js-suggested-changes-blob");if(h){let e=h.querySelectorAll(".js-blob-code-deletion"),n=h.querySelectorAll(".js-blob-code-addition");if(!e)return;let r=Array.from(e).map(e=>e.textContent),l=Array.from(n).map(e=>e.textContent),i=r.length===l.length&&r.every((e,t)=>e===l[t]);if(i){let e=document.querySelector($.unchangedSuggestion).textContent;o.querySelector("details").remove(),W(s,e),t&&(t.setAttribute("disabled","disabled"),t.setAttribute("aria-label",e))}else for(let e of l){let t=document.createElement("input");t.setAttribute("type","hidden"),t.setAttribute("name","value[]"),t.value=e,g.appendChild(t)}}e.replaceWith(o)}}),(0,f.N7)(".js-pull-header-details",{add(e){let t="true"===e.getAttribute("data-pull-is-open"),n=document.querySelector(".js-suggested-changes-template");if(t||!(n instanceof HTMLTemplateElement))return;let r=n?.content,o=document.querySelector($.closedOrMergedPull).textContent;O(r,o),B(o)}}),(0,f.N7)(".js-suggested-changes-subset-files",{add(){let e=document.querySelector(".js-suggested-changes-template");if(!(e instanceof HTMLTemplateElement))return;let t=e.content,n=document.querySelector($.viewingSubset).textContent;O(t,n),B(n)}}),(0,f.N7)(".js-suggested-changes-template",{add(e){let t="true"===e.getAttribute("data-head-oid-is-loaded");if(!(e instanceof HTMLTemplateElement)||t)return;let n=e.content,r=document.querySelector($.headOidNotLoaded)?.textContent||"";O(n,r),B(r)}}),(0,a.on)("click",".js-apply-suggestion-button",async function(e){let t=e.currentTarget.parentElement;if(t){let e=t.querySelector(".js-suggestion-commit-title");setTimeout(()=>e.focus(),1)}}),(0,D.w4)("keypress",".js-comment-field",function(e){if("Enter"===e.key){let t=e.target;(function(e){let t=e.selectionStart;if(!N(e.value,t))return!1;let n=e.value,r=R(n,t);if(null===r)return!1;let o=H(r),s=`
${o}`,l=n.substr(0,t)+s+n.substr(t);(0,_.Se)(e,l);let i=t+s.length;return e.setSelectionRange(i,i),!0})(t)&&e.preventDefault()}}),(0,D.w4)("keypress",".js-suggestion-commit-message",function(e){let t=e.currentTarget;"Enter"===e.key&&t.setAttribute("rows","3")}),(0,a.on)("click",".js-batched-suggested-changes-add",function(e){let t=e.target,n=t.closest(".js-suggested-change-form-container");if("true"===n.getAttribute("data-comment-pending")||"true"===n.getAttribute("data-outdated-comment")||"true"===t.getAttribute("data-batched-suggestion-disabled-by-sibling"))return;n.setAttribute("data-pending-batched-suggestion","true");let r=t.closest(".js-inline-comments-container");for(let e of r.querySelectorAll(".js-batched-suggested-changes-add"))e.setAttribute("data-batched-suggestion-disabled-by-sibling","true");t.removeAttribute("data-batched-suggestion-disabled-by-sibling"),Q()}),(0,a.on)("click",".js-batched-suggested-changes-remove",function(e){let t=e.currentTarget.closest(".js-suggested-change-form-container");t.removeAttribute("data-pending-batched-suggestion");let n=e.currentTarget.closest(".js-inline-comments-container");for(let e of n.querySelectorAll(".js-batched-suggested-changes-add"))e.setAttribute("data-batched-suggestion-reenable-sibling","true");Q()}),(0,a.on)("click",".js-focus-commit-suggestions-form-button",function(e){e.preventDefault(),window.location.href="#clear-commit-suggestions",window.location.href="#commit-suggestions"}),(0,a.on)("click",".js-dismiss-batched-suggested-changes-onboarding-notice",async function(e){let t=e.currentTarget.getAttribute("data-url"),n=e.currentTarget.parentElement.querySelector(".js-data-url-csrf"),r=new FormData;r.append("notice","batched_suggested_changes_onboarding_prompt");let o=await fetch(t,{method:"POST",mode:"same-origin",body:r,headers:{"Scoped-CSRF-Token":n.value,"X-Requested-With":"XMLHttpRequest"}});if(o.ok)for(let e of document.querySelectorAll(".js-batched-suggested-change-onboarding-notice"))e.remove()}),(0,a.on)("click",".js-single-suggested-change-form .js-suggested-changes-submit",function(e){let t=e.currentTarget,n=t.closest(".js-single-suggested-change-form"),r=Array.from(n.querySelectorAll('input[name="value[]"]')).map(e=>e.value),o=[{commentId:n.querySelector("input[name=comment_id]").value,path:n.querySelector("input[name=path]").value,suggestion:r}];X(n,o)}),(0,C.AC)(".js-single-suggested-change-form",async function(e,t){let n=e.closest(".js-suggested-change-form-container"),r=e.closest("details"),o=n.querySelector(".js-suggestion-applied"),s=e.closest(".js-suggested-changes-contents"),l=s.querySelector(".js-error-message-placeholder");try{await t.json(),o.classList.remove("d-none");let e=n.querySelector(".js-batched-suggested-changes-add");e.classList.add("d-none"),r.remove(),(0,P.H5)()}catch(t){if("QueryError"!==t.name){let o=t.response.json&&t.response.json.error,s=l.querySelector(".js-error-message");l.hidden=!1,s.textContent=o,n.prepend(l);let i=e.closest(".js-suggested-change-form-container"),a=i.querySelector(".js-batched-suggested-changes-add");a.classList.add("d-none"),r.remove()}}}),(0,a.on)("click",".js-suggestion-batch-submit",function(e){let t=e.currentTarget.closest(".js-batched-suggested-changes-form"),n=[];for(let e of document.querySelectorAll("[data-pending-batched-suggestion]")){let t=e.querySelector(".js-single-suggested-change-form"),r=Array.from(t.querySelectorAll('input[name="value[]"]')).map(e=>e.value);n.push({commentId:t.querySelector("input[name=comment_id]").value,path:t.querySelector("input[name=path]").value,suggestion:r})}X(t,n)}),(0,C.AC)(".js-batched-suggested-changes-form",async function(e,t){try{await t.json();let n=e.closest(".js-batched-suggested-changes-container");n.hidden=!0,(0,P.H5)()}catch(s){let t=s.response.json&&s.response.json.error,n=e.closest(".js-batched-suggested-changes-container"),r=n.querySelector(".js-error-message-container"),o=r.querySelector(".js-error-message");o.textContent=t,r.hidden=!1}}),(0,f.N7)(".js-files-tab-stale",{add(){let e=document.querySelector(".js-batched-suggested-changes-container");e&&setTimeout(()=>{e.hidden=!0})}});let Z=0;function V(e,t){let n=e.nextElementSibling;return n&&n.matches(t)?n:null}function K(e,t){let n=Array.from(e.querySelectorAll(".review-comment-form-container")).pop();if(n)return n.closest("div.js-line-comments");{let n=er("js-inline-comments-single-container-template",t).querySelector("div.js-line-comments");return e.appendChild(n),n}}function G(e){let t=e.querySelector(".js-toggle-file-notes");t instanceof HTMLInputElement&&(0,_.Se)(t,!0)}function J(){for(let e of document.querySelectorAll(".file .js-inline-comments-container")){let t=e.querySelectorAll(".js-comments-holder > *"),n=t.length>0,r=null!=e.querySelector("[data-resolved='true']"),o=e.querySelector(".js-inline-comment-form-container"),s=!!o&&o.classList.contains("open");n||r||s||e.remove()}}async function Y(e){let t;let n=e.querySelector(".js-suggestion-button-placeholder");if(!n)return;let r=n.getAttribute("data-src-base");if(!r)return;let o=new URL(r,window.location.origin),s=n.closest(".js-inline-comment-form")||n.closest(".js-comment-update");if(!(s instanceof HTMLFormElement))return;let l=function(e,t){let n=new URLSearchParams(e.search.slice(1)),r=t.elements.namedItem("in_reply_to")||t.elements.namedItem("comment_id"),o=t.querySelector("textarea");if(n.append("textarea_id",o.id),r instanceof HTMLInputElement&&r.value)return n.append("comment_id",r.value),n;let s=t.elements.namedItem("path"),l=t.elements.namedItem("start_side"),i=t.elements.namedItem("start_line"),a=t.elements.namedItem("side"),c=t.elements.namedItem("line"),d=t.elements.namedItem("start_commit_oid"),u=t.elements.namedItem("end_commit_oid"),f=t.elements.namedItem("base_commit_oid"),m=t.elements.namedItem("subject_type");return s instanceof HTMLInputElement&&l instanceof HTMLInputElement&&i instanceof HTMLInputElement&&a instanceof HTMLInputElement&&c instanceof HTMLInputElement&&d instanceof HTMLInputElement&&u instanceof HTMLInputElement&&f instanceof HTMLInputElement&&m instanceof HTMLInputElement?(n.append("path",s.value),n.append("start_side",l.value),n.append("start_line",i.value),n.append("end_side",a.value),n.append("end_line",c.value),n.append("start_commit_oid",d.value),n.append("end_commit_oid",u.value),n.append("base_commit_oid",f.value),n.append("subject_type",m.value),n):null}(o,s);if(l){o.search=l.toString();try{t=await (0,T.a_)(document,o.toString())}catch{return}n.textContent="",n.appendChild(t)}}function ee(e,t,n,r){if(e.classList.remove("color-bg-success","color-bg-danger"),r){e.textContent=t;return}if("right"===n){e.classList.add("color-fg-success"),e.textContent=`+${t}`;return}if("left"===n){e.classList.add("color-fg-danger"),e.textContent=`-${t}`;return}e.textContent=String(t)}(0,a.on)("click",".js-add-file-comment",function(e){let t=e.currentTarget,n=t.closest(".file");G(n);let r=function(e){let t=e.closest(".file-header"),n=V(t,".diff-table");if(n instanceof Element){let e=n.querySelector(".js-inline-comments-container");if(e instanceof Element)return e}}(t)||function(e){let t=e.closest(".file-header"),n=document.createElement("table");n.className="diff-table";let r=er("js-inline-comments-single-container-template",e).firstElementChild;return n.appendChild(r),t.after(n),r}(t),o=K(r.querySelector("td"),t),s=o.querySelector(".js-inline-comment-form");if(s instanceof HTMLFormElement){let e=s.getElementsByClassName("js-suggestion-button-placeholder")[0];e&&(e.style.display="none"),en(s,t)}(0,q.j)(o)}),(0,a.on)("click",".js-add-single-line-comment",function(e){let t=e.currentTarget,n=t.closest(".file");G(n);let r=function(e){let t=e.closest("tr"),n=V(t,".js-inline-comments-container");if(n instanceof Element)return n}(t)||function(e){let t=e.closest("tr"),n=er("js-inline-comments-single-container-template",e).firstElementChild;return t.after(n),n}(t),o=K(r.querySelector("td"),t),s=o.querySelector(".js-inline-comment-form");s instanceof HTMLFormElement&&en(s,t),(0,q.j)(o)}),(0,a.on)("click",".js-add-split-line-comment",function(e){let t=e.currentTarget,n=t.closest(".file");G(n);let r=t.closest("tr"),o="addition"===t.getAttribute("data-type")?"js-addition":"js-deletion",s=function(e){let t=V(e,".js-inline-comments-container");if(t)return t;{let n="js-inline-comments-split-container-template",r=document.getElementById(n);if(!r)throw Error(`Could not find element with id ${n}`);if(!(r instanceof HTMLTemplateElement))throw Error(`Found element with id ${n} - but was not a Template`);return t=new E.R(r,{}).firstElementChild,e.after(t),t}}(r),l=function(e,t,n){let r=e.querySelector(`.js-line-comments.${t}`);if(r)return r;let o=er("js-inline-comments-split-form-container-template",n).firstElementChild;o.classList.add(t);let s=e.querySelectorAll(`.${t}`),l=s[s.length-1];for(let e of(l.after(o),s))e.remove();return o}(s,o,t),i=K(l,t),a=i.querySelector(".js-inline-comment-form");a instanceof HTMLFormElement&&en(a,t),(0,q.j)(i)}),(0,C.AC)(".js-inline-comment-form",async function(e,t){let n;(function(e){let t=e.querySelector(".js-comment-form-error");t&&(t.hidden=!0,t.textContent=null)})(e);try{n=await t.json()}catch(t){if(t.response){let n;try{n=t.response.json}catch{}if(n){(function(e,t){let n;let r=e.querySelector(".js-comment-form-error");n=t.errors?Array.isArray(t.errors)?t.errors.join(", "):t.errors:"There was an error posting your comment.",r.textContent=n,r.style.display="block",r.hidden=!1,r.classList.remove("d-none")})(e,n);return}}throw t}let r=n.json,o=r.inline_comment,s=e.closest(".js-line-comments");o&&s.querySelector(".js-comments-holder").append((0,x.r)(document,o));let l=r.inline_comment_thread;l&&s.replaceWith((0,x.r)(document,l)),(0,q.w)(e)}),document.addEventListener("session:resume",function(e){let t=e.detail;(function(e){let[t,n]=e.match(/^new_inline_comment_(?:discussion|diff)_(?:[\w-]+)_(\d+)_(\d+)$/)||[];if(!t)return;let r=document.querySelector(`.js-inline-comment-form input[name='in_reply_to'][value='${n}']`);if(!r)return;let o=r.closest(".js-line-comments");o&&(0,q.j)(o)})(t.targetId),function(e){let[t,n]=e.match(/^new_inline_comment_diff_(?:[\w-]+)_(\d+)$/)||[];if(!t)return;let r=document.querySelector(`.js-add-line-comment[data-anchor='${t}'][data-position='${n}']`);r&&r.click()}(t.targetId)}),(0,f.N7)(".js-comment",{remove:J}),(0,a.on)("inlinecomment:focus",".js-inline-comment-form-container",function(e){let t=e.target.querySelector(".js-suggested-changes-container");t&&Y(t)}),(0,f.N7)(".js-suggested-changes-container.is-comment-editing",e=>{Y(e)}),document.addEventListener("inlinecomment:collapse",()=>{J()});let et={R:"right",L:"left"};function en(e,t){for(let n of["type","path","position","line","side","original-line"]){let r=e.elements.namedItem(n);if(r instanceof HTMLInputElement){let e=t.getAttribute(`data-${n}`)||"";r.value=e}}let n=e.elements.namedItem("subject_type");if(n instanceof HTMLInputElement){let e=t.getAttribute("data-subject-type")||"";n.value=e}let r=e.getElementsByClassName("js-expanded-diff-placeholder-value")?.[0];if(r instanceof HTMLInputElement){let e=t.getAttribute("data-expanded-diff")||"";r.value=e}!function(e,t){let n=(0,L.vu)();if(!n||n.end.is(n.start))return;if(!(0,L.Oz)(t,n)){(0,L.MO)();return}let{start:{lineNumber:r},end:{lineNumber:o}}=n,{start:{side:s},end:{side:l}}=n,i=Number(t.getAttribute("data-line")),a=t.getAttribute("data-side");if(i!==o||!n.end.isContext()&&a!==et[l]){(0,L.MO)();return}let c=et[s],d=e.elements.namedItem("start_line"),u=e.elements.namedItem("start_side"),f=e.elements.namedItem("line"),m=e.elements.namedItem("side"),g=e.elements.namedItem("preview_start_side"),h=e.elements.namedItem("preview_side");if(d instanceof HTMLInputElement&&u instanceof HTMLInputElement&&f instanceof HTMLInputElement&&m instanceof HTMLInputElement&&g instanceof HTMLInputElement&&h instanceof HTMLInputElement){d.value=String(r),u.value=c,u.value=g.value=u.value,h.value=m.value;let t=d.value;s=u.value;let o=f.value;l=m.value;let i=e.closest(".js-inline-comment-form-container");if(t&&o){let e=i.querySelector(".js-multi-line-preview"),r=e.querySelector(".js-multi-line-preview-start"),a=e.querySelector(".js-multi-line-preview-end"),c=n.start.isContext(),d=n.end.isContext();ee(r,t,s,c),ee(a,o,l,d),e.hidden=!1,i.classList.add("is-multiline")}else i.querySelector(".js-multi-line-preview").hidden=!0,i.classList.remove("is-multiline");U(i)}}(e,t)}function er(e,t){let n=document.getElementById(e);if(!n)throw Error(`Could not find element with id ${e}`);if(!(n instanceof HTMLTemplateElement))throw Error(`Found element with id ${e} - but was not a Template`);return new E.R(n,{anchor:t.getAttribute("data-anchor")||"",position:t.getAttribute("data-position")||"",subject_type:t.getAttribute("data-subject-type")||"",sequence:Z++})}var eo=n(70763),es=n(87098),el=n(52191),ei=n(15345);function ea(e){let t=ec();if(!t)return;ed(e,t);let n=function(e,t){let n=function(e,t){let n=/^(diff-[0-9a-f]{32})(?:[L|R]\d+)?$/.exec(t);if(!n)return;let r=n[1],o=e.querySelector(`a[name='${r}']`);if(!o)return;let s=o.nextElementSibling;if(!s||s.querySelector(".js-diff-load-container"))return s}(e,t);return n||function(e,t){let n=/^(?:r|commitcomment-)(\d+)$/.exec(t);if(!n)return;let r=n[1],o=e.querySelector(`#diff-with-comment-${r}`);if(!o)return;let s=o.closest(".js-file");return s}(e,t)}(e,t);n&&((0,c.zT)(n),eu(n))}function ec(){return window.location.hash.slice(1)}function ed(e,t){let n;(n=t.match(/^diff-.+[LR]\d+-[LR]\d+/)?(0,es.Q)(e.ownerDocument,t.substring(0,t.indexOf("-",5))):(0,es.Q)(e.ownerDocument,t))&&e.contains(n)?((0,eo.O4)(n),(0,c.zT)(n)):function(e,t){let n=e.querySelectorAll(".js-comment-container");for(let e of n){let n=e.getAttribute("data-hidden-comment-ids");if(n){let r=n.split(","),o=t.match(/\d+/g)?.[0];if(o&&r.includes(o)){(0,el.$)(e);break}}}}(e,t)}function eu(e){let t=e.querySelector(".js-diff-entry-loader"),n=e.querySelector(".js-diff-placeholder"),r=e.querySelector("button.js-diff-load"),o=e.querySelector(".js-button-text");n.setAttribute("fill","url('#animated-diff-gradient')"),o.textContent=r.getAttribute("data-disable-with")||"",r.disabled=!0;let s=new URL(t.getAttribute("data-fragment-url")||"",window.location.origin);return t.src=s.toString(),t.data}(0,f.N7)(".js-diff-progressive-container",function(e){ea(e);let t=e.querySelector(".js-diff-progressive-loader");t&&t.addEventListener("load",function(){ea(e)})}),(0,f.N7)(".js-diff-load-container",function(e){let t=e.querySelector(".js-diff-entry-loader");t&&t.addEventListener("load",function(){let t=e.closest(".js-file");t.classList.remove("hide-file-notes-toggle"),(0,ei.N)(e);let n=ec();n&&ed(e,n)})}),(0,a.on)("click",".js-diff-load",function(e){if(e.target.classList.contains("js-ignore-this"))return;let t=e.currentTarget.closest(".js-diff-load-container");eu(t),t?.focus(),(0,ei.x)("Loading...")});var ef=n(9302);(0,a.on)("click",".js-rendered, .js-source",function(e){let t=e.currentTarget;if(t.classList.contains("selected")){e.preventDefault();return}(function(e){let t=e.closest(".js-file-header"),n=e.classList.contains("js-rendered"),r=e.classList.contains("js-source"),o=t.getAttribute("data-short-path"),s=t.getAttribute("data-anchor"),l=new URL(window.location.href,window.location.origin),i=new URLSearchParams(l.search.slice(1));l.hash=s,n?i.set("short_path",o):r&&i.delete("short_path"),l.search=i.toString(),(0,ef.lO)(null,"",l.toString())})(t),function(e){for(let e of document.querySelectorAll(".js-rendered, .js-source"))e.classList.remove("selected"),e.removeAttribute("aria-current");e.classList.add("selected"),e.setAttribute("aria-current","true")}(t)}),(0,C.AC)(".js-prose-diff-toggle-form",async function(e,t){let n=e.closest(".js-details-container"),r=n.querySelector(".js-file-content"),o=await t.html();for(;r.lastChild;)r.removeChild(r.lastChild);r.append(o.html),n.classList.toggle("display-rich-diff")}),(0,a.on)("click",".js-toc-retry",function(e){if(!(e.target instanceof Element))return;let t=e.target.closest(".select-menu"),n=t.querySelector("include-fragment"),r=n.getAttribute("src");n.setAttribute("src",""),n.setAttribute("src",r)}),(0,a.on)("click",".js-code-scanning-apply-autofix-form .js-code-scanning-apply-autofix-submit",function(e){let t=e.currentTarget,n=t.closest(".js-code-scanning-apply-autofix-form"),r=n.querySelector("input[name=commit_title]"),o=n.querySelector("textarea[name=commit_message]"),s=r.value.trim();""===s&&(s=r.defaultValue);let l=o.value.trim();""!==l&&(s=`${s}

${l}
`),r.disabled=!0,o.disabled=!0;let i=document.createElement("input");i.setAttribute("type","hidden"),i.setAttribute("name","message"),i.value=s,n.appendChild(i)}),(0,C.AC)(".js-code-scanning-apply-autofix-form",async function(e,t){let n=e.closest("details"),r=e.closest(".js-code-scanning-apply-autofix-container"),o=r.querySelector(".js-error-message-placeholder");try{await t.json(),n.remove(),(0,P.H5)()}catch(e){if("QueryError"!==e.name){let t=e.response.json&&e.response.json.error,r=o.querySelector(".js-error-message");o.hidden=!1,r.textContent=t,n.remove()}}});var em=n(75198);function eg(e,t,n){let r=Array.from(e.querySelectorAll('[role="menuitem"]')),o=r.indexOf(t),s=r.indexOf(n);if(-1===o)throw Error("Couldn't find startIndex in container");if(-1===s)throw Error("Couldn't find endItem in container");for(let t of(ep(e),r[s].classList.add("is-last-in-range"),o>s&&([o,s]=[s,o]),r.slice(o,s+1)))t.classList.add("is-range-selected")}async function eh(e,t){function n(n){eg(e,t,n.target.closest('[role="menuitem"]'))}eg(e,t,t),e.addEventListener("mouseover",n),await new Promise(e=>window.addEventListener("keyup",e,{once:!0})),e.removeEventListener("mouseover",n),ep(e)}function ep(e){for(let t of e.querySelectorAll('[role="menuitem"]'))t.classList.remove("is-range-selected","is-last-in-range")}(0,f.N7)(".js-diffbar-range-menu .js-diffbar-range-list",{subscribe:function(e){let t=e.closest("details-menu"),n=!1;function r(e){(n=e.shiftKey)&&e.preventDefault()}function o(t){if(!n)return;t.preventDefault();let r=t.detail.relatedTarget;if(r.classList.contains("is-range-selected")){t.stopPropagation();let n=e.querySelectorAll(".is-range-selected"),r=n[0],o=n[n.length-1],s=e.getAttribute("data-range-url"),l=r.getAttribute("data-parent-commit"),i=o.getAttribute("data-commit"),a=l&&i?`${l}..${i}`:i,c=s.replace("$range",a);(0,em.softNavigate)(c)}else t.stopImmediatePropagation(),eh(e,r)}return e.addEventListener("click",r,{capture:!0}),t.addEventListener("details-menu-select",o),{unsubscribe:()=>{e.removeEventListener("click",r,{capture:!0}),t.removeEventListener("details-menu-select",o)}}}}),(0,a.on)("toggle",".js-diffbar-range-menu",function(e){let t=e.currentTarget;if(!t.hasAttribute("open"))return;let n=t.querySelector(".in-range");n&&n.focus()},{capture:!0});var eb=n(97629);(0,a.on)("click",".js-compare-tab",function(e){for(let e of document.querySelectorAll(".js-compare-tab.selected"))e.classList.remove("selected");for(let t of(e.currentTarget.classList.add("selected"),document.querySelectorAll("#commits_bucket, #files_bucket, #commit_comments_bucket")))t.classList.add("d-none");let t=e.currentTarget,n=t.hash;document.querySelector(n).classList.remove("d-none"),e.preventDefault()}),(0,u.Z)(function({target:e}){if(!(e instanceof HTMLElement))return;let t=e.closest("#commits_bucket, #files_bucket, #commit_comments_bucket");t&&t instanceof HTMLElement&&!(0,eb.Z)(t)&&document.querySelector(`.js-compare-tab[href="#${t.id}"]`).click()}),(0,a.on)("click",".js-toggle-range-editor-cross-repo",function(){document.querySelector(".js-range-editor").classList.toggle("is-cross-repo")}),(0,f.N7)(".js-compare-pr.open",{add(){document.body.classList.add("is-pr-composer-expanded")},remove(){document.body.classList.remove("is-pr-composer-expanded")}}),(0,a.on)("change",".js-collab-checkbox",function({currentTarget:e}){let t=e.form;for(let e of t.querySelectorAll(".errored"))e.classList.remove("errored");let n=e.closest(".js-collab-option"),r=n.querySelector(".js-status-indicator");r.classList.remove("status-indicator-success","status-indicator-failed"),r.classList.add("status-indicator-loading")}),(0,C.AC)(".js-collab-form",async function(e,t){try{await t.text()}catch(t){for(let t of e.querySelectorAll(".status-indicator-loading")){t.classList.remove("status-indicator-loading"),t.classList.add("status-indicator-failed");let e=t.closest(".js-collab-option");e.classList.add("errored");let n=e.querySelector(".js-collab-checkbox");n.checked=!n.checked}for(let t of e.querySelectorAll(".status-indicator-success"))t.classList.remove("status-indicator-success");return}for(let t of e.querySelectorAll(".errored"))t.classList.remove("errored");for(let t of e.querySelectorAll(".status-indicator-loading"))t.classList.remove("status-indicator-loading"),t.classList.add("status-indicator-success")});var ey=n(76006),ej=n(3447);function ev(e,t,n){if(!t.has(e))throw TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function eS(e,t){var n=ev(e,t,"get");return n.get?n.get.call(e):n.value}function ew(e,t,n){!function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function eA(e,t,n){var r=ev(e,t,"set");return!function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw TypeError("attempted to set read only private field");t.value=n}}(e,r,n),n}function eq(e,t,n,r){var o,s=arguments.length,l=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(l=(s<3?o(l):s>3?o(t,n,l):o(t,n))||l);return s>3&&l&&Object.defineProperty(t,n,l),l}let eL=(r=new WeakMap,o=new WeakMap,s=new WeakMap,l=new WeakMap,(i=class DiffLayoutElement extends HTMLElement{connectedCallback(){if(!this.sidebarContainer)return;eA(this,l,new MutationObserver(this.handleNotificationShelfMutation)),eS(this,l).observe(document.body,{subtree:!0,childList:!0});let{signal:e}=eA(this,s,new AbortController);window.addEventListener("scroll",this.handleSidebarScroll,{signal:e}),window.addEventListener("resize",()=>this.handleSidebarResize(),{signal:e}),this.handleSidebarScroll()}disconnectedCallback(){this.sidebarContainer&&(eS(this,l).disconnect(),eS(this,s)?.abort(),null!=eS(this,r)&&cancelAnimationFrame(eS(this,r)),null!=eS(this,o)&&cancelAnimationFrame(eS(this,o)))}toggleSidebar(e){if(this.layoutContainer.classList.toggle("hx_Layout--sidebar-hidden"),this.sidebarHidden=!this.sidebarHidden,!this.fileTree)return;let t=e.detail.toggleButton;t&&(this.fileTree.instrumentToggleFileTree(t),this.fileTreePathFilter&&"show-file-tree-button"===t.id&&this.fileTreePathFilter.focus())}handleOpenFilesListHotkeyEvent(){if(this.shouldOpenTocMenu()){this.tocMenuButton.click();return}this.fileTree&&(this.showFileTreeButton&&this.sidebarHidden?this.showFileTreeButton.click():this.fileTreePathFilter&&!this.sidebarHidden&&this.fileTreePathFilter.focus())}shouldOpenTocMenu(){return!!(this.tocMenu&&!this.tocMenu.hasAttribute("open")&&"none"!==window.getComputedStyle(this.tocMenu).display)}handleNotificationShelfMutation(e){let t=document.firstElementChild;if(t.classList.contains("js-skip-scroll-target-into-view"))for(let n of e){for(let e of n.addedNodes)if(e instanceof HTMLElement&&e.classList.contains("js-notification-top-shelf")){t.classList.add("has-notification-top-shelf");break}for(let e of n.removedNodes)if(e instanceof HTMLElement&&e.classList.contains("js-notification-top-shelf")){t.classList.remove("has-notification-top-shelf");break}}}handleSidebarResize(){eA(this,o,requestAnimationFrame(this.updateSidebarHeight))}constructor(...e){super(...e),ew(this,r,{writable:!0,value:void 0}),ew(this,o,{writable:!0,value:void 0}),ew(this,s,{writable:!0,value:void 0}),ew(this,l,{writable:!0,value:void 0}),this.sidebarHidden=!1,eA(this,r,null),eA(this,o,null),this.handleSidebarScroll=()=>{eA(this,r,requestAnimationFrame(this.updateSidebarHeight))},this.updateSidebarHeight=()=>{let e;if(!this.sidebarContainer)return;let t=document.documentElement.clientHeight,n=this.diffToolbar.getBoundingClientRect(),r=this.mainContainer.getBoundingClientRect(),o=t>=r.bottom,s=0===n.top;o?(e=r.bottom-parseInt(this.sidebarContainer.style.top),e=Math.min(r.height,e)):e=s?t-n.height:t-this.sidebarContainer.getBoundingClientRect().top,this.sidebarContainer.style.height=`${e}px`}}}).attrPrefix="",i);eq([ey.Lj],eL.prototype,"sidebarHidden",void 0),eq([ey.fA],eL.prototype,"layoutContainer",void 0),eq([ey.fA],eL.prototype,"diffToolbar",void 0),eq([ey.fA],eL.prototype,"tocMenu",void 0),eq([ey.fA],eL.prototype,"tocMenuButton",void 0),eq([ey.fA],eL.prototype,"mainContainer",void 0),eq([ey.fA],eL.prototype,"sidebarContainer",void 0),eq([ey.fA],eL.prototype,"fileTree",void 0),eq([ey.fA],eL.prototype,"showFileTreeButton",void 0),eq([ey.fA],eL.prototype,"fileTreePathFilter",void 0),eq([(0,ej.D)(100)],eL.prototype,"handleSidebarResize",null),eL=eq([ey.Ih],eL),(0,a.on)("click",".js-split-diff-view",function(){let e=document.querySelector(".js-unified-diff-view-box"),t=document.querySelector(".js-split-diff-view-box"),n=document.querySelector(".js-split-diff-view-option"),r=document.querySelector(".js-unified-diff-view-option");t.classList.add("color-border-accent-emphasis"),t.classList.remove("color-border-default"),e.classList.remove("color-border-accent-emphasis"),e.classList.add("color-border-default"),r.checked=!1,n.checked=!0}),(0,a.on)("click",".js-unified-diff-view",function(){let e=document.querySelector(".js-unified-diff-view-box"),t=document.querySelector(".js-split-diff-view-box"),n=document.querySelector(".js-split-diff-view-option"),r=document.querySelector(".js-unified-diff-view-option");t.classList.remove("color-border-accent-emphasis"),t.classList.add("color-border-default"),e.classList.add("color-border-accent-emphasis"),e.classList.remove("color-border-default"),r.checked=!0,n.checked=!1});var eE=n(67044),e_=n(29764);let eT=class InstrumentFilesElement extends HTMLElement{connectedCallback(){document.addEventListener("keydown",this.instrumentCtrlF)}disconnectedCallback(){document.removeEventListener("keydown",this.instrumentCtrlF)}constructor(...e){super(...e),this.instrumentCtrlF=e=>{let t=(0,eE.EL)(e);["Control+f","Meta+f"].includes(t)&&(0,e_.sz)(this)}}};eT=function(e,t,n,r){var o,s=arguments.length,l=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(l=(s<3?o(l):s>3?o(t,n,l):o(t,n))||l);return s>3&&l&&Object.defineProperty(t,n,l),l}([ey.Ih],eT);var ex=n(27034),eC=n(5582);(0,a.on)("details:toggled",".js-pull-merging",function({currentTarget:e}){let t=Array.from(e.querySelectorAll(".js-merge-pull-request")),n=t.some(eb.Z);for(let e of t)e.classList.toggle("is-dirty",n)}),(0,a.on)("click",".js-merge-box-try-again",async function({currentTarget:e}){let t=e.getAttribute("data-form-target");if(!["js-cleanup-branch-form","js-merge-branch-form","js-queue-branch-form","js-update-branch-form"].includes(t))return;let n=e.closest(".js-pull-merging").getElementsByClassName(t)[0];(0,a.f)(n,"submit")}),document.addEventListener("session:resume",function(e){let t=document.getElementById(e.detail.targetId);if(t){let e=t.closest(".js-merge-pull-request");if(e){let t=e.closest(".js-details-container");t&&t.classList.add("open")}}}),(0,a.on)("change",".js-admin-merge-override",function({currentTarget:e}){let t=e.closest(".js-merge-message-container"),n=e.checked,r=t.querySelector(".js-merge-box"),o=t.querySelector(".js-auto-merge-box"),s=t.querySelector(".js-merge-form"),l=t.querySelector(".js-auto-merge-form"),i=t.querySelector(".js-queue-branch-form"),a=t.querySelectorAll(".merge-box-button");for(let e of(r&&(r.hidden=!n),o&&(o.hidden=n),s&&(s.hidden=!n),l&&(l.hidden=n),i&&(i.hidden=n),a))e.disabled=!n}),(0,a.on)("details-menu-selected",".js-update-branch-method-menu",function(e){let t=e.detail.relatedTarget,n=t.closest(".js-merge-pr");n.classList.toggle("is-updating-via-merge","merge"===t.value),n.classList.toggle("is-updating-via-rebase","rebase"===t.value);let r=n.querySelector(".js-update-branch-type");r&&(r.value=t.value)},{capture:!0}),(0,a.on)("submit",".js-update-branch-form",function({currentTarget:e}){let t=e.closest(".js-merge-pr"),n=t?.querySelector(".btn-group-update-merge");n&&(n.disabled=!0);let r=t?.querySelector(".btn-group-update-rebase");r&&(r.disabled=!0);let o=t?.querySelector(".js-update-method-menu-button");o&&(o.classList.add("disabled","user-select-none"),o.setAttribute("aria-disabled","true"));let s=t?.querySelector(".js-update-branch-method-menu");s&&s?.parentNode?.removeChild(s)}),(0,a.on)("details-menu-selected",".js-merge-method-menu",function(e){let t=e.detail.relatedTarget,n=t.closest(".js-merge-pr"),r=n.querySelector(".js-merge-pull-request"),o=n.querySelector(".js-merge-method-menu-button"),s=o.getAttribute("data-merge-button-class");o.classList.toggle("btn-danger",t.hasAttribute("data-dangerous-action")),s&&o.classList.toggle(s,!t.hasAttribute("data-dangerous-action"));let l=n.querySelectorAll(".js-merge-title"),i=n.querySelectorAll(".js-merge-message"),a=document.querySelectorAll(".js-merge-method-menu button");for(let e of a)e.setAttribute("aria-checked",e.value===t.value?"true":"false");for(let e of l)e.defaultValue===e.value&&(e.defaultValue=e.value=t.getAttribute("data-input-title-value"));for(let e of i)e.defaultValue===e.value&&(e.defaultValue=e.value=t.getAttribute("data-input-message-value"));n.classList.toggle("is-merging","merge"===t.value),n.classList.toggle("is-squashing","squash"===t.value),n.classList.toggle("is-rebasing","rebase"===t.value),n.classList.toggle("is-merging-group","group"===t.value),n.classList.toggle("is-merging-solo","solo"===t.value),n.classList.toggle("is-merging-jump","jump"===t.value);let c=r.classList.contains("js-admin-override-merge")&&"merge"===t.value||r.classList.contains("js-admin-override-squash")&&"squash"===t.value||r.classList.contains("js-admin-override-rebase")&&"rebase"===t.value,d=n.querySelector(".js-merge-type");d&&(d.value=t.value);let u=n.querySelectorAll(".js-merge-pull-request .js-merge-commit-button,.js-confirm-auto-merge-button");for(let e of u)t.value===e.value?(e.type="submit",e.classList.contains("js-confirm-auto-merge-button")&&(0,eC.j)(e)):e.type="button";r.classList.toggle("color-fg-danger",c);let f=n.closest(".js-pull-merging"),m=new URL(f.getAttribute("data-url"),window.location.origin),g=new URLSearchParams(m.search);g.set("merge_type",t.value),m.search=g.toString(),f.setAttribute("data-url",m.toString())},{capture:!0}),(0,a.on)("details:toggled",".js-merge-pr",function(e){let t=e.currentTarget,n=t.querySelector(".js-merge-message");n&&(0,a.f)(n,"change")}),(0,f.N7)(".branch-action-item.js-details-container.open",{add(e){for(let t of e.querySelectorAll(".js-merge-review-section"))t.setAttribute("open","")},remove(e){for(let t of e.querySelectorAll(".js-merge-review-section"))t.removeAttribute("open")}}),(0,a.on)("toggle",".js-details-container .js-merge-review-section",function({currentTarget:e}){let t=e.closest(".js-details-container"),n=t.querySelectorAll(".js-merge-review-section").length,r=t.querySelectorAll(".js-merge-review-section[open]").length;0===r?(0,eo.Qp)(t,{force:!1}):r===n&&(0,eo.Qp)(t,{force:!0})},{capture:!0}),(0,f.N7)("poll-include-fragment[data-to-be-polled]",{constructor:ex.Z,add(e){function t(){e.src=e.getAttribute("data-to-be-polled"),e.removeAttribute("data-to-be-polled")}document.hidden?document.addEventListener("visibilitychange",t,{once:!0}):t()}}),(0,a.on)("submit",".js-remove-from-queue-form",async e=>{let t=e.currentTarget;e.preventDefault();let n=await fetch(t.action,{method:t.method,body:new FormData(t),headers:{Accept:"application/json"}});n&&n.ok||(window.onbeforeunload=()=>{window.scrollTo({top:0})},window.location.reload())});var ek=n(96776);let eM=!1;function eI(){let e=document.querySelectorAll(".pull-request-ref-restore");for(let t=0;t<e.length;t++)e[t].classList.toggle("last",t===e.length-1)}function eR(){let e=null!=document.querySelector("#js-pull-restorable"),t=document.querySelector(".js-pull-discussion-timeline");t&&t.classList.toggle("is-pull-restorable",e)}document.addEventListener("keydown",function(e){"Alt"===e.key&&(eM=!0)}),document.addEventListener("keyup",function(e){"Alt"===e.key&&(eM=!1)}),(0,a.on)("click",".js-toggle-outdated-comments",function(e){if(!(e instanceof MouseEvent&&e.altKey||eM)||!(e.currentTarget instanceof HTMLElement))return;let t=e.currentTarget,n=t.closest("details");function r(){let e=n.hasAttribute("open");for(let n of document.querySelectorAll(".js-toggle-outdated-comments"))if(n!==t){let t=n.closest("details");t.toggleAttribute("open",e)}}setTimeout(()=>{(0,ek.uQ)(t,r)})}),(0,f.N7)(".pull-request-ref-restore",{add:eI,remove:eI}),(0,f.N7)("#js-pull-restorable",{add:eR,remove:eR});var eH=n(54679);function eF(e){let t=document.querySelector(".js-reviews-container");t&&setTimeout(()=>(function(e,t){let n=e.closest(".js-review-state-classes"),r=document.querySelector(".js-review-changes");for(let e of(n.classList.toggle("is-review-pending",t>0),document.querySelectorAll(".js-pending-review-comment-count")))e.textContent=String(t);for(let e of document.querySelectorAll(".js-pending-comment-count-type"))e instanceof HTMLElement&&(e.textContent=e.getAttribute(1===t?"data-singular-string":"data-plural-string"));if(t>0){r.textContent=r.getAttribute("data-pending-message")||"";let t=e.querySelector(".js-reviews-toggle");t?.classList.add("anim-pulse-in"),t?.addEventListener("animationend",()=>t.classList.remove("anim-pulse-in"),{once:!0})}else r.textContent=r.getAttribute("data-message")||""})(t,e))}function eN(e){return e.getAttribute("ratio").split("/")}function eD(e){if(e){let[t,n]=eN(e),r=parseInt(t)/parseInt(n),o=e.querySelector(".js-review-progress"),s=e.querySelector(".js-review-count");o instanceof HTMLElement&&s&&(o.style.width=`${100*r}%`,s.textContent=`${t} / ${n}`)}}(0,C.AC)(".js-inline-comment-form",async function(e,t){let n=await t.text();eF(n.json.pendingReviewCommentsCount)}),(0,C.AC)(".js-pending-review-comment .js-comment-delete",async function(e,t){let n=await t.text();eF(n.json.pendingReviewCommentsCount)}),(0,C.AC)(".js-resolvable-timeline-thread-form",async function(e,t){try{let n=await t.html(),r=e.closest(".js-resolvable-timeline-thread-container");r.replaceWith(n.html)}catch(e){(0,eH.v)()}}),(0,C.AC)(".js-toggle-user-reviewed-file-form",async function(e,t){let n=e.closest(".js-details-container"),r=!!n.querySelector(".js-reviewed-file"),o=n.querySelector(".js-file-level-comments-table"),s=n.classList.contains("open"),l=n.querySelector(".js-file-header"),i=!!l&&60===l.getBoundingClientRect().top;(!r&&s||r&&!s)&&((0,eo.Qp)(n),o&&o.classList.toggle("hidden"),i&&(0,c.zT)(n));let a=e.querySelector(".js-reviewed-toggle");r?(a.classList.remove("color-bg-accent","color-border-accent"),a.classList.add("color-fg-muted","color-border-default")):(a.classList.remove("color-fg-muted","color-border-default"),a.classList.add("color-bg-accent","color-border-accent"));let d=a.querySelector(".js-reviewed-checkbox");d.disabled=!0;let u=document.querySelector("progress-bar");u instanceof eP&&(r?u.decrement():u.increment());let f=document.getElementById(`file-tree-item-${n.id}`);f&&f.toggleAttribute("data-file-user-viewed");try{let r=await t.html(),o=e.closest(".js-replace-file-header-review");o&&(o.replaceWith(r.html),n.toggleAttribute("data-file-user-viewed"))}catch(t){let e=document.querySelector("template.js-flash-template");e.after(new E.R(e,{className:"flash-error",message:"There was an error marking the file as viewed."})),d.checked=!1,d.disabled=!1}});let eP=class ProgressBarElement extends HTMLElement{static get observedAttributes(){return["ratio"]}attributeChangedCallback(e){"ratio"===e&&eD(this)}connectedCallback(){eD(this)}increment(){let[e,t]=eN(this),n=Math.min(parseInt(e)+1,parseInt(t));this.setAttribute("ratio",`${n}/${t}`)}decrement(){let[e,t]=eN(this),n=Math.min(parseInt(e)-1,parseInt(t));n=Math.max(n,0),this.setAttribute("ratio",`${n}/${t}`)}};window.customElements.get("progress-bar")||(window.ProgressBarElement=eP,window.customElements.define("progress-bar",eP));var e$=n(4412),eO=n(55908),eB=n(40458);function eW(e,t){let n=document.querySelector("template.js-flash-template");n.after(new E.R(n,{className:"flash-error",message:e})),t.removeAttribute("open")}function ez(e,t,n){let r=t.closest(".js-pull-merging");if(!r)return;r.classList.add("is-error");let o=r.getElementsByClassName("merge-branch-description")[0];o.textContent=e;let s=r.querySelector("input[name='expected_head_oid']");s&&(s.value=n)}document.addEventListener(eO.Q.SUCCESS,function(){for(let e of document.querySelectorAll(".js-pull-refresh-on-pjax"))(0,P.x0)(e)}),(0,a.on)("click",".js-change-base-form-button",async function(e){e.preventDefault();let t=e.currentTarget,n=t.querySelector(".js-change-base-spinner");t.disabled=!0,n.style.display="inline",await (0,eB.Z)();let r=e.target.closest("details");try{let e=t.form,n=await fetch(e.action,{method:e.method,body:new FormData(e),headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}}),o=await n.json();if((0,eo.Qp)(document.querySelector(".js-pull-header-details"),{force:!1}),!n.ok){eW(o.error_message,r);return}let s=null;s=o.job?o.job.url:o.orchestration.url;let l=await (await (0,T.DF)(s,{headers:{accept:"application/json"}})).json();if(l.orchestration){if(!l.orchestration.error_message)return(0,P.H5)();eW(l.orchestration.error_message,r)}else{if(!l.job.error_message)return(0,P.H5)();eW(l.job.error_message,r)}}catch(e){eW("An unknown error occured.",r)}}),(0,C.AC)(".js-update-branch-async-button",async function(e,t){await (0,eB.Z)();try{let n=await t.json(),r=await (await (0,T.DF)(n.json.orchestration.url,{headers:{accept:"application/json"}})).json();if(r.orchestration.error_message)ez(r.orchestration.error_message,e,r.orchestration.current_head_sha);else if(e.getElementsByClassName("js-update-branch-type")[0]?.getAttribute("value")==="rebase")return(0,P.H5)()}catch(t){ez("An unknown error occured.",e,"")}}),(0,f.N7)(".js-updating-pull-request-commits-count",{add(e){let t=e.textContent,n=document.querySelectorAll(".js-updateable-pull-request-commits-count");for(let e of n)e.textContent=t}}),(async()=>{if(await e$.x,window.performance&&window.performance.navigation&&window.performance.navigation.type===window.performance.navigation.TYPE_RELOAD){let e=document.getElementById("js-report-pull-request-refresh");e&&(0,e_.Fk)(e)}})();var eU=n(37574),eQ=n(75297);function eX(e){(0,eo.O4)(e),(0,c.zT)(e)}async function eZ(e,t){let{anchor:n,side:r,line:o,lastLine:s,hashFragment:l,partialHashFragment:i}=e,a=(0,es.Q)(document,n);if(!a)return;let c=eG(a,r,o,s);if(!c.length){let e=(0,es.Q)(document,l);if(e){eX(e);return}let t=a.querySelector(".js-diff-load-container");if(!t)return;try{await function(e){let t=e.querySelector(".js-diff-entry-loader"),n=e.querySelector(".js-diff-placeholder"),r=e.querySelector("button.js-diff-load"),o=e.querySelector(".js-button-text");n.setAttribute("fill","url('#animated-diff-gradient')"),o.textContent=r.getAttribute("data-disable-with")||"",r.disabled=!0;let s=new URL(t.getAttribute("data-fragment-url")||"",window.location.origin);return t.src=s.toString(),t.data}(t);let e=(0,es.Q)(document,l);e instanceof HTMLElement&&eX(e)}catch(e){eX(a)}return}await Promise.all(c.map(e=>eV(e,i)));let d=(0,es.Q)(document,l),u=eG(a,r,o,s);u.length?eZ(e,t):d?eX(d):t<1&&eZ(e,t+1)}async function eV(e,t){let n;if(t){let r="R"===t.slice(-1)?"data-right-range":"data-left-range",o=e.getAttribute(r)||"",s=parseInt(o.split("-")[0],10);n=t+s}else n=e.hash.slice(1);let r=e.getAttribute("data-url"),o=new URL(r,window.location.origin),s=new URLSearchParams(o.search.slice(1));s.append("anchor",n),o.search=s.toString();let l=await (0,T.a_)(document,o.toString()),i=e.closest(".js-file");if(!i)return;let c=e.closest(".js-expandable-line"),d=eK(c,".file-diff-line");d?(0,ek.uQ)(d,()=>{c.replaceWith(l)}):c.replaceWith(l),(0,a.f)(i,"expander:expanded"),function(e){let t=e.querySelector(".js-expand-full-wrapper");if(!t)return;let n=Array.from(e.querySelectorAll(".js-expand"));0===n.length&&t.parentElement.removeChild(t)}(i)}function eK(e,t){let n=e.nextElementSibling;return n instanceof HTMLElement&&n.matches(t)?n:null}function eG(e,t,n,r){let o=parseInt(n,10),s=parseInt(r||"",10);return Array.from(e.querySelectorAll(".js-expand")).filter(e=>{let n=(e.getAttribute("R"===t?"data-right-range":"data-left-range")||"").split("-"),r=parseInt(n[0],10),l=parseInt(n[1],10);return!!(r<=o)&&!!(o<=l)||!!(o<=r)&&!!(l<=s)||!!(r<=s)&&!!(s<=l)})}async function eJ(e,t){let n=await self.fetch(t,{headers:{"Content-Type":"application/json",Accept:"application/json"}});if(!n.ok)throw Error(`Request to blob_expand failed with status code ${n.status}`);let r=await n.json();return r.map(t=>({...t,content:(0,x.r)(e,t.content)}))}function eY(e,t){return!!(e instanceof HTMLElement&&(0,eQ.ur)(e))&&t(e)}(0,u.Z)(function(){let e=function(e){if(!e)return;let t=(0,eU.s)(e);if(!t)return;let n=t[1],r=t[2],o=t[3],s=t[5];return{anchor:n,side:r,line:o,lastLine:s,hashFragment:n+r+o,partialHashFragment:n+r}}(window.location.hash);if(e){if((0,es.Q)(document,e.hashFragment)&&!e.lastLine)return;eZ(e,0)}}),(0,a.on)("click",".js-expand",function(e){e.preventDefault(),eV(e.currentTarget)}),(0,a.on)("click",".js-expand-full",async e=>{e.preventDefault();let t=e.currentTarget,n=t.closest(".file"),r=t.getAttribute("data-url"),o=function(e){let t=Array.from(e.querySelectorAll(".js-expand")),n=t.map((e,t)=>(function(e,t){let n=new URL(e.getAttribute("data-url"),window.location.origin),r=n.searchParams;return{position:t.toString(),left:{start:r.get("last_left"),end:r.get("left"),size:r.get("left_hunk_size")},right:{start:r.get("last_right"),end:r.get("right"),size:r.get("right_hunk_size")}}})(e,t)),r=!1,o=[];for(let e=0;e<n.length;e++){if(r){r=!1;continue}let t=n[e],s=n[e+1];r=!!s&&t.left.start===s.left.start&&t.left.end===s.left.end&&t.right.start===s.right.start&&t.right.end===s.right.end,o.push(t)}return o}(n);function s(){t.setAttribute("hidden","true");let e=n.querySelector(".js-collapse-diff");e&&e.removeAttribute("hidden"),n.classList.add("open"),n.classList.add("Details--on")}if(eY(n,eQ.j))return void s();if(0===o.length)return;let l=new URL(r,window.location.origin),i=new URLSearchParams(l.search.slice(1));for(let e of o)i.append("ranges[]last_left",e.left.start),i.append("ranges[]left",e.left.end),i.append("ranges[]left_hunk_size",e.left.size),i.append("ranges[]last_right",e.right.start),i.append("ranges[]right",e.right.end),i.append("ranges[]right_hunk_size",e.right.size),i.append("ranges[]position",e.position);l.search=i.toString();let a=await eJ(document,l.toString()),c=[...n.querySelectorAll(".js-expand")];for(let{content:e,position:t}of a){let n=parseInt(t,10),r=c[n];if(!r)return;let o=r.closest(".js-expandable-line"),s=eK(o,".file-diff-line");s?(0,ek.uQ)(s,()=>{o.after(e)}):o.after(e),o.setAttribute("hidden","true")}s()}),(0,a.on)("click",".js-collapse-diff",e=>{let t=e.currentTarget,n=t.closest(".file");function r(){t.setAttribute("hidden","true");let e=n.querySelector(".js-expand-full");e&&e.removeAttribute("hidden")}if(eY(n,eQ.fK))return void r();let o=[...n.querySelectorAll('.blob-expanded[data-expanded-full="true"]')];for(let e of o)e.parentElement.removeChild(e);let s=[...n.querySelectorAll(".js-expandable-line")];for(let e of s)e.removeAttribute("hidden");r()});let DiffTableSideProtection=class DiffTableSideProtection{range(){let e;return this.selection?.rangeCount>0&&(e=this.selection.getRangeAt(0)),e}canBeSideProtected(){try{return!!(this.hasSelectedText()&&this.confinedTable())}catch(e){return!1}}isSideProtected(){try{return!!this.confinedTable()?.getAttribute("data-lock-side-selection")}catch(e){return!1}}hasSelectedText(){let e=this.range();return!!e&&e.toString().length>0}clearSelectedText(){this.selection.removeAllRanges()}confinedTable(){let e=this.range()?.commonAncestorContainer?.parentElement;if(e?.matches(".diff-table"))return e;if(e?.matches(".js-file-content")){let t=e?.querySelector("table.diff-table");return t}{let t=e?.closest("table.diff-table");return t}}unprotectedSide(){let e;return e=this.anchorNode instanceof HTMLTableCellElement?this.anchorNode.closest("td[data-split-side]"):this.anchorNode?.parentElement?.closest("td[data-split-side]"),e?.getAttribute("data-split-side")}protectedSide(){return"left"===this.unprotectedSide()?"right":"left"}applySideProtection(){if(this.unprotectedSide()){let e=this.confinedTable(),t=this.unprotectedSide();e&&t&&e.setAttribute("data-lock-side-selection",t)}}clearSideProtection(){let e=document.querySelectorAll("table[data-lock-side-selection]");for(let t of e)t.removeAttribute("data-lock-side-selection")}filteredTableRows(){let e=[];for(let t=0;t<this.selection.rangeCount;t++){let n=this.selection.getRangeAt(t),r=n.cloneContents();if(r.querySelectorAll("td").length){let t=`td[data-split-side=${this.protectedSide()}], td.js-linkable-line-number, td.empty-cell, .inline-comments`,n=r.querySelectorAll(t);for(let e of n)e.parentNode&&e.parentNode.removeChild(e);e.push(...r.children)}else{let t=document.createElement("TR"),n=document.createElement("TD");n.append(...r.childNodes),t.append(n),e.push(t)}}return e}contentToString(){let e=[],t=document.createElement("table");t.classList.add("invisible"),t.append(...this.filteredTableRows()),this.confinedTable()?.append(t);let n=t.children;for(let t=0;t<n.length;t++){let r=n[t],o=r.innerText;o&&("\n"===o?e.push(""):e.push(o))}return t.remove(),e.join("\n")}constructor(e){this.selection=e,this.anchorNode=e.anchorNode}};function e0(e){return Math.floor(e/2)}function e1(e,t){let n=e.parentElement;n&&(!function(e){let t=e.querySelector(".js-comment-button-placeholder");if(t?.parentElement){let n=document.querySelector(".js-comment-button-template");if(!n)throw Error("missing js-comment-button-template template element!");let r=t.dataset;if(!r)throw Error("placeholder element has no dataset");r.originalLine=e.querySelector(".blob-code-inner")?.textContent||"";let o=new E.R(n,r);if(t.parentElement.replaceChild(o,t),r.expandedDiff){let t=e.querySelector(".js-add-line-comment");t&&t.setAttribute("data-expanded-diff",r.expandedDiff)}}}(n),function(e,t,n){let r;let o=e.children;if(4===o.length)for(let e=0,n=o.length;e<n;e++){let n=o[e];n===t&&(r=e0(e))}for(let e=0,t=o.length;e<t;e++){let t=o[e];(null==r||e0(e)===r)&&t.classList.toggle("is-hovered",n)}}(n,e,t))}function e7(e){let t=document.getSelection();if(t){let n=new DiffTableSideProtection(t);n.isSideProtected()&&(e.clipboardData?.setData("text/plain",n.contentToString()),e.preventDefault())}}function e3(e){let t=document.getSelection(),n=2===e.button;if(t&&!n){let e=new DiffTableSideProtection(t);e.isSideProtected()&&(e.clearSelectedText(),e.clearSideProtection())}}function e5(){let e=document.getSelection();if(e){let t=new DiffTableSideProtection(e);t.canBeSideProtected()?t.applySideProtection():t.clearSideProtection()}}function e4(){let e=document.querySelector("meta[name=diff-view]"),t=e&&e instanceof HTMLMetaElement?e.content:"",n=document.querySelector(".js-file-diff-split"),r=!!("split"===t&&n||document.querySelector(".wants-full-width-container"));document.body.classList.toggle("full-width",r)}function e2(e){let t=e.some(e=>e.checked);for(let n of e)(0,_.Se)(n,!t)}function e8(e,t,n,r){var o,s=arguments.length,l=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(l=(s<3?o(l):s>3?o(t,n,l):o(t,n))||l);return s>3&&l&&Object.defineProperty(t,n,l),l}(0,f.N7)(".diff-table",function(e){let t=null;function n(){t&&e1(t,!1),t=null}function r(e){t&&e1(t,!1),e.target instanceof HTMLElement&&(t=e.target.closest("td.blob-code"))&&e1(t,!0)}return{add:function(){e.addEventListener("mouseenter",n),e.addEventListener("mouseleave",n),e.addEventListener("mouseover",r)},remove:function(){e.removeEventListener("mouseenter",n),e.removeEventListener("mouseleave",n),e.removeEventListener("mouseover",r)}}}),(0,f.N7)(".js-diff-container",function(){return{add:function(){document.addEventListener("copy",e7),document.addEventListener("mousedown",e3),document.addEventListener("selectionchange",e5)},remove:function(){document.removeEventListener("copy",e7),document.removeEventListener("mousedown",e3),document.removeEventListener("selectionchange",e5)}}}),n(99874),(0,f.N7)("meta[name=diff-view]",{add:e4,remove:e4}),(0,f.N7)(".js-file-diff-split",{add:e4,remove:e4}),(0,f.N7)(".js-compare-tab.selected",{add:e4,remove:e4}),(0,f.N7)(".wants-full-width-container",{add:e4,remove:e4}),(0,a.on)("change",".js-toggle-file-notes",function(e){let t=e.currentTarget;t.closest(".file").classList.toggle("show-inline-notes",t.checked)}),(0,a.on)("click",".js-toggle-all-file-notes",function(e){let t=Array.from(document.querySelectorAll(".js-toggle-file-notes"));e2(t),e.preventDefault()}),(0,a.on)("click",".js-toggle-all-file-annotations",function(e){let t=Array.from(document.querySelectorAll(".js-toggle-file-check-annotations"));e2(t),e.preventDefault()}),(0,f.N7)(".js-inline-comments-container",function(e){let t;let n=e.closest(".file");if(n){let e=t=function(){let e=null!=n.querySelector(".js-inline-comments-container");n.classList.toggle("has-inline-notes",e)};return{add:e,remove:t}}}),(0,a.on)("change",".js-toggle-file-check-annotations",function(e){let t=e.currentTarget,n=t.closest(".file").querySelectorAll(".js-inline-annotations");for(let e of n)e instanceof HTMLElement&&(e.hidden=!t.checked)});let e9=class DiffFileFilterElement extends HTMLElement{connectedCallback(){this.filterState={hideDeletedFiles:!1,hideViewedFiles:!1,showManifestFilesOnly:!1,selectedOwners:[],showCodeownersFiles:!1,selectedFileTypes:[],fileTypeFilterActive:!1,filtersActive:!1}}applyFilter(e){this.filterState=e.detail,this.showResetFilters(),this.filterFiles(),this.filterTreeFiles(),this.hideEmptyDirectories(),this.showBlankslateIfEmpty()}clearFilters(e){e.preventDefault(),this.fileFilter.clearFilters()}filterFiles(){for(let e of this.diffEntries){let t=e.closest(".js-file.js-details-container");t.hidden=!this.shouldShowFile(e)}}filterTreeFiles(){for(let e of this.treeEntries){let t=this.shouldShowFile(e);e.hidden=!t,e.toggleAttribute("data-skip-substring-filter",!t)}}hideEmptyDirectories(){this.treeRoot&&this.hideEmptyDirectory(this.treeRoot)}hideEmptyDirectory(e){let t="root"===e.getAttribute("data-tree-entry-type"),n="directory"===e.getAttribute("data-tree-entry-type");if(t||n){let n=e.querySelectorAll(t?":scope > .js-tree-node":":scope > ul > .js-tree-node"),r=0;for(let e of n)r+=this.hideEmptyDirectory(e);return 0===r?(e.hidden=!0,0):(e.hidden=!1,1)}return e.hidden?0:1}async refilterAfterAsyncLoad(){await Promise.resolve(),this.refilterLoadedFiles(),this.showBlankslateIfEmpty()}refilterLoadedFiles(){this.filterState.filtersActive&&this.filterFiles()}shouldShowFile(e){let t=!0,n=e.getAttribute("data-file-type");if(n&&(t=this.filterState.selectedFileTypes.includes(n)),this.filterState.hideViewedFiles&&t){let n=e.hasAttribute("data-file-user-viewed");n&&(t=!1)}if(this.filterState.showCodeownersFiles&&t){let n=(e.getAttribute("data-codeowners")||"").split(",");t=n.filter(e=>this.filterState.selectedOwners.includes(e)).length>0}if(this.filterState.hideDeletedFiles&&t){let n="true"===e.getAttribute("data-file-deleted");n&&(t=!1)}if(this.filterState.showManifestFilesOnly&&t){let n=e.hasAttribute("data-file-manifest");n||(t=!1)}return t}showResetFilters(){this.resetFilters&&(this.resetFilters.hidden=!this.filterState.filtersActive)}showBlankslateIfEmpty(){if(!this.blankslate)return;if(this.progressiveLoaders.length>0||0===this.diffEntries.length){this.blankslate.hidden=!0;return}let e=Array.from(this.diffEntries).some(e=>!e.hidden);this.blankslate.hidden=e}};e8([ey.fA],e9.prototype,"blankslate",void 0),e8([ey.fA],e9.prototype,"resetFilters",void 0),e8([ey.GO],e9.prototype,"diffEntries",void 0),e8([ey.GO],e9.prototype,"progressiveLoaders",void 0),e8([ey.GO],e9.prototype,"treeEntries",void 0),e8([ey.fA],e9.prototype,"treeRoot",void 0),e8([ey.fA],e9.prototype,"fileFilter",void 0),e8([(0,ej.D)(20)],e9.prototype,"hideEmptyDirectories",null),e9=e8([ey.Ih],e9);var e6=n(54177);let te=class InputDemuxBaseChangeContext{onItemSelected(e){if(!(e.currentTarget instanceof HTMLButtonElement))return;let t=e.currentTarget.querySelector(".js-ref-name").textContent,n=document.querySelector(".js-new-base-branch");n.value=btoa(unescape(encodeURIComponent(t||"")));let r=document.querySelector(".js-change-base-template").content.cloneNode(!0);r instanceof DocumentFragment&&(0,e6.W)({content:r})}},tt=class InputDemuxContextWrapperElement extends HTMLElement{connectedCallback(){let e=this.getAttribute("data-context-type"),t={baseChange:new te};this.context=t[e]}onItemSelected(e){this.context.onItemSelected(e)}};tt=function(e,t,n,r){var o,s=arguments.length,l=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(l=(s<3?o(l):s>3?o(t,n,l):o(t,n))||l);return s>3&&l&&Object.defineProperty(t,n,l),l}([ey.Ih],tt),n(55843),n(82368),n(58541),n(57088)},78232:(e,t,n)=>{n.d(t,{j:()=>l,w:()=>i});var r=n(59753),o=n(64611),s=n(254);function l(e){let t=e.querySelector(".js-inline-comment-form-container");t.classList.add("open"),t.querySelector(".js-write-tab")?.click(),t.querySelector(".js-comment-field").focus(),(0,r.f)(t,"inlinecomment:focus")}function i(e){e.reset();let t=e.closest(".js-inline-comment-form-container");t.classList.remove("open");let n=t.querySelector(".js-multi-line-preview");n&&(n.hidden=!0),(0,r.f)(t,"inlinecomment:collapse")}(0,r.on)("click",".js-toggle-inline-comment-form",function(e){let t=e.currentTarget.closest(".js-line-comments");l(t)}),(0,r.on)("quote-selection",".js-line-comments",function(e){l(e.currentTarget),e.stopPropagation()}),(0,s.w4)("keydown",".js-inline-comment-form-container form .js-comment-field",function(e){let t=e.target;if(!t.classList.contains("js-navigation-enable")&&"Escape"===e.key&&0===t.value.length){let n=t.closest("form");i(n),e.preventDefault()}}),(0,r.on)("click",".js-hide-inline-comment-form",function(e){let t=e.currentTarget.closest("form");!(0,o.T)(t)||confirm(e.currentTarget.getAttribute("data-confirm-cancel-text"))?i(t):e.preventDefault()})},33537:(e,t,n)=>{n.d(t,{X:()=>o});var r=n(9302);function o(e,t,n,o,s,l,i,a,c=window.location.search){let d=document.querySelector(".js-file-filter"),u=new URL(window.location.href,window.location.origin),f=new URLSearchParams(c),m=f.get("w");if(!e&&!o){if(l)return;let e=new URLSearchParams,t=f.get("diff");t&&e.set("diff",t),m&&e.set("w",m),u.search=e.toString(),(0,r.lO)((0,r.y0)(),"",u.toString());return}let g=d.querySelector(".js-file-filter-form"),h=new FormData(g),p=n.filter(e=>!h.getAll("file-filters[]").includes(e)),b=s.filter(e=>!h.getAll("owned-by[]").includes(e));for(let e of p)h.append("file-filters[]",e);for(let e of b)h.append("owned-by[]",e);let y=new URLSearchParams(h);y.has("file-filters[]")&&""!==y.toString()||y.set("file-filters[]",""),t&&y.set("w",m??"1"),l&&y.set("manifests","true"),i&&y.set("show-deleted-files","false"),a&&y.set("show-viewed-files","false"),y.delete("authenticity_token"),u.search=y.toString(),(0,r.lO)((0,r.y0)(),"",u.toString())}},55843:(e,t,n)=>{var r=n(76006);function o(e,t,n,r){var o,s=arguments.length,l=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(l=(s<3?o(l):s>3?o(t,n,l):o(t,n))||l);return s>3&&l&&Object.defineProperty(t,n,l),l}let s=class InputDemuxElement extends HTMLElement{connectedCallback(){this.control&&(this.storedInput=Array(this.control.children.length).fill("")),this.addEventListener("input",this.relayInput.bind(this)),this.addEventListener("keydown",this.relayKeydown.bind(this));let e=this.closest("details");e&&e.addEventListener("toggle",()=>{e.open&&this.source.focus()})}relayKeydown(e){if((this.isControlTab(e.target)||e.target===this.source)&&("ArrowDown"===e.key||"Tab"===e.key))e.preventDefault(),e.stopPropagation(),this.routeCustomEvent(new CustomEvent("focus-list"));else if("Escape"===e.key){let e=this.closest("details");e&&e.removeAttribute("open")}}isControlTab(e){return!!e&&!!this.control&&Array.from(this.control.children).includes(e)}relayInput(e){if(!e.target)return;let t=e.target,n=t.value;this.routeCustomEvent(new CustomEvent("input-entered",{detail:n}))}routeCustomEvent(e){let t=this.sinks[this.selectedIndex];t.dispatchEvent(e)}get selectedIndex(){if(!this.control)return 0;let e=this.control.querySelector('[aria-selected="true"]');return e?Array.from(this.control.children).indexOf(e):0}storeInput(){this.storedInput[this.selectedIndex]=this.source.value}updateInput(e){this.source.value=this.storedInput[this.selectedIndex];let t=e.detail.relatedTarget.getAttribute("data-filter-placeholder");this.source.placeholder=t,this.source.setAttribute("aria-label",t),this.notifySelected()}notifySelected(){let e=this.sinks[this.selectedIndex],t=new CustomEvent("tab-selected");e.dispatchEvent(t)}};o([r.fA],s.prototype,"source",void 0),o([r.GO],s.prototype,"sinks",void 0),o([r.fA],s.prototype,"control",void 0),s=o([r.Ih],s)},58541:(e,t,n)=>{(0,n(36071).N7)("#js-spoofed-commit-warning-trigger",{add:()=>{let e=document.getElementById("spoof-warning");if(!e)return;let t=document.querySelector(".commit-title");t&&t.classList.add("pb-1"),e.hidden=!1,e.removeAttribute("aria-hidden")}})},40458:(e,t,n)=>{n.d(t,{Z:()=>d});var r=n(54177),o=n(82873);function s(e){let t=document.querySelector(".sso-modal");t&&(t.classList.remove("success","error"),e?t.classList.add("success"):t.classList.add("error"))}async function l(){let e=document.querySelector("link[rel=sso-modal]"),t=await (0,r.W)({content:(0,o.a_)(document,e.href),dialogClass:"sso-modal"}),n=null,l=window.external;if(l.ssoComplete=function(e){e.error?s(n=!1):(s(n=!0),function(e){let t=document.querySelector("meta[name=sso-expires-around]");t&&t.setAttribute("content",e)}(e.expiresAround),window.focus()),l.ssoComplete=null},await new Promise(e=>{t.addEventListener("dialog:remove",e,{once:!0})}),!n)throw Error("sso prompt canceled")}async function i(){let e=document.querySelector("link[rel=sso-session]"),t=document.querySelector("meta[name=sso-expires-around]");if(!(e instanceof HTMLLinkElement)||!function(e){if(!(e instanceof HTMLMetaElement))return!0;let t=parseInt(e.content),n=new Date().getTime()/1e3;return n>t}(t))return!0;let n=e.href,r=await fetch(n,{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}}),o=await r.json();return o}(0,n(36071).N7)(".js-sso-modal-complete",function(e){if(window.opener&&window.opener.external.ssoComplete){let t=e.getAttribute("data-error"),n=e.getAttribute("data-expires-around");window.opener.external.ssoComplete({error:t,expiresAround:n}),window.close()}else{let t=e.getAttribute("data-fallback-url");t&&(window.location.href=t)}});let a=null;function c(){a=null}async function d(){let e=await i();e||(a||(a=l().then(c).catch(c)),await a)}},54177:(e,t,n)=>{n.d(t,{W:()=>o});var r=n(59753);async function o(e){let t=document.querySelector("#site-details-dialog"),n=t.content.cloneNode(!0),o=n.querySelector("details"),s=o.querySelector("details-dialog"),l=o.querySelector(".js-details-dialog-spinner");e.detailsClass&&o.classList.add(...e.detailsClass.split(" ")),e.dialogClass&&s.classList.add(...e.dialogClass.split(" ")),e.label?s.setAttribute("aria-label",e.label):e.labelledBy&&s.setAttribute("aria-labelledby",e.labelledBy),document.body.append(n);try{let t=await e.content;l.remove(),s.prepend(t)}catch(n){l.remove();let t=document.createElement("span");t.textContent=e.errorMessage||"Couldn't load the content",t.classList.add("my-6"),t.classList.add("mx-4"),s.prepend(t)}return o.addEventListener("toggle",()=>{o.hasAttribute("open")||((0,r.f)(s,"dialog:remove"),o.remove())}),s}},82873:(e,t,n)=>{n.d(t,{DF:()=>d,Fr:()=>u,a_:()=>c});var r=n(18699);let o=class ResponseError extends Error{constructor(e,t){super(`${e} for HTTP ${t.status}`),this.response=t}};var s=n(22490),l=n(7180);let i="server-x-safe-html",a=s.ZO.createPolicy(i,{createHTML:(e,t)=>l.O.apply({policy:()=>(!function(e,t,n=!1){let r=t.headers.get("content-type")||"";if(!n&&!r.startsWith("text/html"))throw new o(`expected response with text/html, but was ${r}`,t);if(n&&!(r.startsWith("text/html")||r.startsWith("application/json")))throw new o(`expected response with text/html or application/json, but was ${r}`,t);let s=t.headers.get("x-html-safe");if(s){if(!e.includes(s))throw new o("response X-HTML-Safe nonce did not match",t)}else throw new o("missing X-HTML-Safe nonce",t)}(function(e){let t=[...e.querySelectorAll("meta[name=html-safe-nonce]")].map(e=>e.content);if(t.length<1)throw Error("could not find html-safe-nonce on document");return t}(document),t),e),policyName:i,fallback:e,silenceErrorReporting:!0})});async function c(e,t,n){let o=new Request(t,n);o.headers.append("X-Requested-With","XMLHttpRequest");let s=await self.fetch(o);if(s.status<200||s.status>=300)throw Error(`HTTP ${s.status}${s.statusText||""}`);let l=a.createHTML(await s.text(),s);return(0,r.r)(e,l)}function d(e,t,n=1e3,r=[200],o=[202]){return async function n(s){let l=new Request(e,t);l.headers.append("X-Requested-With","XMLHttpRequest");let i=await self.fetch(l);if(o.includes(i.status))return await new Promise(e=>setTimeout(e,s)),n(1.5*s);if(r.includes(i.status))return i;if(i.status<200||i.status>=300)throw Error(`HTTP ${i.status}${i.statusText||""}`);throw Error(`Unexpected ${i.status} response status from poll endpoint`)}(n)}async function u(e,t,n){let{wait:r=500,acceptedStatusCodes:o=[200],max:s=3,attempt:l=0}=n||{},i=async()=>new Promise((n,i)=>{setTimeout(async()=>{try{let r=new Request(e,t);r.headers.append("X-Requested-With","XMLHttpRequest");let i=await self.fetch(r);if(o.includes(i.status)||l+1===s)return n(i);n("retry")}catch(e){i(e)}},r*l)}),a=await i();return"retry"!==a?a:u(e,t,{wait:r,acceptedStatusCodes:o,max:s,attempt:l+1})}}},e=>{var t=t=>e(e.s=t);e.O(0,["vendors-node_modules_dompurify_dist_purify_js","vendors-node_modules_stacktrace-parser_dist_stack-trace-parser_esm_js-node_modules_github_bro-a4c183","vendors-node_modules_github_selector-observer_dist_index_esm_js","vendors-node_modules_lit-html_lit-html_js","vendors-node_modules_morphdom_dist_morphdom-esm_js","vendors-node_modules_github_turbo_dist_turbo_es2017-esm_js","vendors-node_modules_virtualized-list_es_index_js-node_modules_github_template-parts_lib_index_js","vendors-node_modules_github_remote-form_dist_index_js-node_modules_delegated-events_dist_inde-a4ae14","vendors-node_modules_github_mini-throttle_dist_decorators_js-node_modules_scroll-anchoring_di-087b76","ui_packages_failbot_failbot_ts","app_assets_modules_github_updatable-content_ts","app_assets_modules_github_ref-selector_ts","app_assets_modules_github_sticky-scroll-into-view_ts","app_assets_modules_github_diffs_blob-lines_ts-app_assets_modules_github_diffs_linkable-line-n-d80317","app_assets_modules_github_behaviors_ajax-error_ts-app_assets_modules_github_behaviors_include-467754"],()=>t(92967)),e.O()}]);
//# sourceMappingURL=diffs-a3a0e89b84b5.js.map